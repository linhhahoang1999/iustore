{% extends 'base.html' %}
{% load static %}
{% load number_format %}
{% block title %}
<title>

</title>
{% endblock title %}

{% block style %}
<style>

</style>
{% endblock style %}

{% block content %}
<div class="container pt-4">

    <!-- product detail -->
    <div class="product-detail">
        <div class="product-img">
            {% with 'images/product/'|add:img_path as image_path %}
                <img src="{% static image_path %}"
                    height="400px" width="600px" alt="Máy Tính Bảng Samsung Galaxy">
            {% endwith %}
        </div>
        <div style="margin: 0px 12px; width: 1px; background: rgb(242, 242, 242);"></div>
        <div class="product-content">
            <div class="product-header">
                <h1 class="product-title">{{item.name}}</h1>
                {% comment %} <div class="product-bellow-title">
                    <span style="margin-right: 12px;">
                        5 <i style="color: rgb(253, 216, 53);" class="fas fa-star"></i>
                    </span>
                    <a href="#" style="cursor: pointer; color: inherit; text-decoration: none;"> (Xem 1 đánh giá)
                    </a>
                    <span
                        style="width: 1px; height: 15px; background-color: rgb(199, 199, 199); margin: 0 8px 0 8px"></span>
                    
                </div> {% endcomment %}
            </div>
            <div class="product-body">
                <div class="product-price">
                    {% if discount_rate %}
                        <span class="product-price__current-price">{{discount_price|int_format}} đ</span>
                        <span class="product-price__price">{{current_price|int_format}} đ </span>
                        <span class="product-price__discount-rate">{{discount_rate}} %</span>
                    
                    {% else %}
                        <span class="product-price__current-price">{{current_price|int_format}} đ</span>
                    {% endif %}
                </div>
                <div class="add-to-cart">
                    <div class="qty">
                        <div class="qty-input">
                            <button class="qty-btn qty-minus" style="border-right: none;">
                                <img src="{% static 'images/icons-remove.svg' %}" alt="icon remove">
                            </button>
                            <input type="text" value="1" class="qty-value">
                            <button class="qty-btn qty-add" style="border-left: none;">
                                <img src="{% static 'images/icons-add.svg' %}" alt="icon remove">
                            </button>
                        </div>
                    </div>
                    <div>
                        <button class="btn btn-add-to-cart" id="addToCart">Chọn Mua</button>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- product similary-->
    <h5 style="font-weight: 400; ">CÁC SẢN PHẨM TƯƠNG TỰ
    </h5>
    <div class="product mt-3" style="padding: 20px;">
        <div style="margin-left: 20px;">
            
        </div>
        <div style="display: flex; flex-wrap: wrap; ">
            {% for item, path, discount_rate in items %}
            <div class="item d-inline-block"
                style="display:flex;flex-direction: column; justify-content: space-between; padding: 5px; margin: 10px 25px 30px 25px; width: 215px;  font-family: Arial, Helvetica, sans-serif;">
                <a href="{% url 'mystore:item-detail' item_id=item.id %}" style="color: black; text-decoration: none;">
                    <div class="thumbnail pb-2 pt-2">
                        <div class="badge-top">
                        {% with 'images/product/'|add:path as image_path %}
                            <img src="{% static image_path %}"
                                width="205px" height="200px" alt="Máy Tính Bảng Samsung Galaxy">
                        {% endwith %}
                        </div>
                    </div>
                    <div class="info">
                        <div class="name" style="height: 50px; font-size: 15px;">
                            {{item.product.name}}
                        </div>
                        {% comment %} <div class="row ml-auto ">
                            <span class="rate">
                                5 <i class="fas fa-star"></i>
                            </span>
                            <span class="review"> (50) </span>
                        </div> {% endcomment %}
                        <div class="row ml-auto">
                            <span class="price">
                                {{item.product.price|int_format}} ₫
                            </span>
                            {% if discount_rate %}
                                <span class="sale">
                                    {{discount_rate}}
                                </span>
                            {% endif %}
                        </div>
                    </div>
                </a>
            </div>
            {% endfor %}
        </div>
    </div>


    <!-- product description -->
    <div class="product-description">
        <h5 style="font-weight: 400; ">THÔNG TIN CHI TIẾT
        </h5>
        <div class="product-basic-info">
            <div class="product-attributes">
                {% for attr in attrs %}
                <div class="product-attribute-item">{{attr}}</div>
                {% endfor %}
            </div>
            <div class="product-attributes-value">
                {% for attr_value in attribute_values %}
                <div class="product-attribute-item">{{attr_value}}</div>
                {% endfor %}
            </div>
        </div>
        <h5 style="font-weight: 400; margin-top: 40px;"> MÔ TẢ SẢN PHẨM
        </h5>
        <div class="product-description-detail">
            <div class="content">
                {% comment %} Thông Số Kỹ Thuật: <br>

                - Màu sắc: Đen - Xám <br>

                - Chữ khắc Laser chống bay <br>

                - Kết nối: USB 2.0, tương thích mọi hệ điều hành <br>

                - Độ bền phím > 10.000.000 lượt bấm <br>

                Bàn phím led chuyên game giả cơ với thiết kế tựa như 1 bàn phím cơ với đường nét và kiểu dáng rất phá
                cách, hệ thống đèn led dưới nền cực kỳ ấn tượng với 7 gam màu trải đều trên bàn phím. Giúp người dùng,
                đặc biệt là các game thủ có thể thoải mái sử dụng vào ban đêm. <br>

                Giá sản phẩm trên Tiki đã bao gồm thuế theo luật hiện hành. Tuy nhiên tuỳ vào từng loại sản phẩm hoặc
                phương thức, địa chỉ giao hàng mà có thể phát sinh thêm chi phí khác như phí vận chuyển, phụ phí hàng
                cồng kềnh, ... <br> {% endcomment %}
                {{product.description}}
            </div>
        </div>
    </div>
    <!-- customer review -->
    <div class="customer-reviews">
        <h5 style="font-weight: 400;">
            ĐÁNH GIÁ - NHẬN XÉT TỪ KHÁCH HÀNG
        </h5>
        {% if comment %}
        <div class="customer-comment">
            <form action="{% url 'mystore:item-review' %}" method="post">
                {% csrf_token %}
                <div class="customer-rate">
                    <div>
                        <input type="radio" id="one" name="rate" value="1">
                        <label for="one">
                            <i style="color: rgb(255, 181, 0);" class="fas fa-star"></i>
                        </label>
                    </div>
                    <div>
                        <input type="radio" id="two" name="rate" value="2">
                        <label for="two">
                            <i style="color: rgb(255, 181, 0);" class="fas fa-star"></i>
                            <i style="color: rgb(255, 181, 0);" class="fas fa-star"></i>
                        </label>
                    </div>
                    <div>
                        <input type="radio" id="three" name="rate" value="3">
                        <label for="three">
                            <i style="color: rgb(255, 181, 0);" class="fas fa-star"></i>
                            <i style="color: rgb(255, 181, 0);" class="fas fa-star"></i>
                            <i style="color: rgb(255, 181, 0);" class="fas fa-star"></i>
                        </label>
                    </div>
                    <div>
                        <input type="radio" id="four" name="rate" value="4">
                        <label for="four">
                            <i style="color: rgb(255, 181, 0);" class="fas fa-star"></i>
                            <i style="color: rgb(255, 181, 0);" class="fas fa-star"></i>
                            <i style="color: rgb(255, 181, 0);" class="fas fa-star"></i>
                            <i style="color: rgb(255, 181, 0);" class="fas fa-star"></i>
                        </label>
                    </div>
                    <div>
                        <input type="radio" id="five" name="rate" value="5">
                        <label for="five">
                            <i style="color: rgb(255, 181, 0);" class="fas fa-star"></i>
                            <i style="color: rgb(255, 181, 0);" class="fas fa-star"></i>
                            <i style="color: rgb(255, 181, 0);" class="fas fa-star"></i>
                            <i style="color: rgb(255, 181, 0);" class="fas fa-star"></i>
                            <i style="color: rgb(255, 181, 0);" class="fas fa-star"></i>
                        </label>
                    </div>
                </div>
                <textarea name="customer-comment" class="customer-comment form-control"></textarea>
                <input type="hidden" name="item_id" value="{{item.id}}">
                <div style="display: flex; justify-content: flex-end;">
                    <button type="submit" class="btn btn-outline-success" style=" margin-bottom: 8px;">Gửi bình
                        luận</button>
                </div>
            </form>
        </div>
        {% endif %}
        <div class="customer-reviews__inner">
            {% for feedback,rates in feedBacks %}
            
            <div class="review-comment">
                <div class="review-comment__user">
                    <div class="review-comment__user-avatar">

                    </div>
                    <div class="review-comment__user-info">
                        <div class="review-comment__user-name">{{feedback.customer.member.name}}</div>
                        {% comment %} <div class="review-comment__user-date"> Đã tham gia 1 năm</div> {% endcomment %}
                    </div>
                </div>
                <div class="review-comment__comment">
                    <div class="review-comment__rating">
                        <div class="review-comment__rating-star">
                            {% for rate in rates %}
                                <span><i class="fas fa-star"></i></span>
                            {% endfor %}
                        </div>
                        {% comment %} <div class="review-comment__rating-text">
                            Cực kỳ hài lòng
                        </div> {% endcomment %}
                    </div>
                    <div class="review-comment__content">
                        {{feedback.comment.content}}
                    </div>
                    {% comment %} <div class="review-comment__images">
                        <div class="review-comment__image-item"
                            style="background-image: url('https://vcdn.tikicdn.com/ts/review/12/78/f3/fdb18507bd7603e83be9492af9458641.jpg');">
                        </div>
                    </div> {% endcomment %}
                    <div class="review-comment_created-date">
                        <span>Nhận xét vào {{feedback.created_date}}</span>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    <script>
        $('#addToCart').click(() => {
            $.ajax({
                url: "http://127.0.0.1:8000/mystore/add-to-cart",
                type: 'GET',
                data: {
                    'item_id': "{{request.resolver_match.kwargs.item_id}}",
                    'qty': 1
                },
                dataType: 'json',
                success: function (res) {
                    console.log(res);
                }
            });
        })
    </script>
    <script src="{% static 'js/add-to-cart.js' %}"></script>
    {% endblock content %}